#!/usr/bin/env bash
# --------------------------------------------------------------------
#  empty_cells:  count the empty cells in every column of the dataset
#  Author: Shivam Sharma
# Outputs column names and count of empty cells per column.

# --------------------------------------------------------------------

if [ "$#" -ne 2 ]; then
    echo "Usage: $0 <file> <separator>" >&2
    exit 1
fi

FILE=$1
SEP=$2

awk -v FS="$SEP" '
    NR==1 {
        for (i=1;i<=NF;i++) hdr[i]=$i
        next
    }
    {
        for (i=1;i<=NF;i++)
            if ($i=="") cnt[i]++
    }
    END {
        for (i=1;i<=length(hdr);i++)
            printf "%s: %d\n", hdr[i], cnt[i]+0
    }
' "$FILE"
